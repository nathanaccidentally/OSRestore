#!/bin/bash

echo "THIS PACKAGE WILL ASSIST IN ERASING YOUR DEVICE, YOU AGREE TO USE THIS AT YOUR OWN RISK. THANKS FOR THE METHOD /u/changemylife99."
echo "Thanks to contributions from ipadkid358 and thebeastgamer25"
tput bold
echo "If you would like to quit, exit Cydia NOW! I have purpousefully added a 10 second hang time for you to exit if needed. Use this time wisley."
tput sgr0
sleep 10

echo "Updating your repos. This is needed to install MTerminal"
apt-get update

echo "Installing MTerminal."
apt-get install com.officialscheduler.mterminal
echo "Done! Moving on to the actual erase!"


echo "THIS IS YOUR LAST CHANCE TO CLOSE CYDIA WITH NO ERASING DONE. YOU HAVE 5 SECONDS."
sleep 5

echo "Starting erase..."
rm /.installed_yaluX
echo "Removed Yalu file."

cd /var/mobile/

echo "Removing /var/mobile and it's contents..."
rm -R Backups
rm -R Containers
rm -R Documents
rm -R Downloads
rm -R Media
rm -R MobileSoftwareUpdate
echo "Removed all contents except for Library from /var/mobile."

echo "Removing the contents of /var/mobile/Library except for carrier settings and important files..."
echo "This step could take the longest."

echo "Final erase starting."
shopt -s extglob

rm -R /var/mobile/Library/* !(Carrier Bundle.Bundle|Carrier Bundles|CarrierDefault.Bundle|Operator Bundle.Bundle)

echo "Removing stashed tweaks..."
cd /var/db/
rm -R stash

echo "Done removing stashed tweaks. Removing Cydia Substrate..."
echo "This should have dpkg remove all leftover tweak files and such."
apt-get --yes remove mobilesubstrate
echo "Removed mobilesubstrate. DO NOT RESPRING, I REPEAT, DO NOT RESPRING. YOU HAVE BEEN WARNED."
sleep 5

echo "Removing any other temporary files caused by Cydia and other tweaks."
rm /tmp/cydia.log
rm /tmp/flush.log
rm -R /Library/Themes
echo "Just removed Cydia log. More could be added soon over time, but this shouldnt matter to much."

tput bold
echo "PLEASE GO TO SETTINGS IMMEDIATLEY AND USE ERASE ALL CONTENTS AND SETTINGS! THIS TWEAK ONLY DOES HALF OF THE WORK NEEDED. PLEASE DO THIS!"
tput sgr0
